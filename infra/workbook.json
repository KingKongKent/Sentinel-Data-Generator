{
  "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {
    "workbookDisplayName": {
      "type": "string",
      "defaultValue": "Sentinel Data Generator - Demo Data Overview",
      "metadata": {
        "description": "Display name for the workbook"
      }
    },
    "workbookSourceId": {
      "type": "string",
      "metadata": {
        "description": "Resource ID of the Log Analytics workspace"
      }
    }
  },
  "variables": {
    "workbookId": "[guid(resourceGroup().id, parameters('workbookDisplayName'))]"
  },
  "resources": [
    {
      "type": "Microsoft.Insights/workbooks",
      "apiVersion": "2022-04-01",
      "name": "[variables('workbookId')]",
      "location": "[resourceGroup().location]",
      "kind": "shared",
      "properties": {
        "displayName": "[parameters('workbookDisplayName')]",
        "serializedData": "[concat('{\"version\":\"Notebook/1.0\",\"items\":[{\"type\":1,\"content\":{\"json\":\"# Sentinel Data Generator - Demo Data Overview\\n\\nThis workbook displays data generated by the [Sentinel Data Generator](https://github.com/KingKongKent/Sentinel-Data-Generator) tool.\\n\\n**Tables:**\\n- SecurityEventDemo_CL (Windows security events)\\n- CommonSecurityLog (CEF/firewall events - native table)\\n- SigninLogDemo_CL (Azure AD sign-in events)\\n- SyslogDemo_CL (Linux syslog events)\\n- BruteForceDemo_CL (Live brute force PIN demo)\"},\"name\":\"header\"},{\"type\":11,\"content\":{\"version\":\"LinkItem/1.0\",\"style\":\"tabs\",\"links\":[{\"id\":\"tab-overview\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Overview\",\"subTarget\":\"overview\",\"style\":\"link\"},{\"id\":\"tab-security\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Security Events\",\"subTarget\":\"security\",\"style\":\"link\"},{\"id\":\"tab-cef\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"CommonSecurityLog\",\"subTarget\":\"cef\",\"style\":\"link\"},{\"id\":\"tab-signin\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Sign-in Logs\",\"subTarget\":\"signin\",\"style\":\"link\"},{\"id\":\"tab-syslog\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Syslog\",\"subTarget\":\"syslog\",\"style\":\"link\"},{\"id\":\"tab-alerts\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Alerts & Incidents\",\"subTarget\":\"alerts\",\"style\":\"link\"},{\"id\":\"tab-bruteforce\",\"cellValue\":\"tab\",\"linkTarget\":\"parameter\",\"linkLabel\":\"Brute Force Demo\",\"subTarget\":\"bruteforce\",\"style\":\"link\"}]},\"name\":\"tabs\"},{\"type\":9,\"content\":{\"version\":\"KqlParameterItem/1.0\",\"parameters\":[{\"id\":\"time-range\",\"version\":\"KqlParameterItem/1.0\",\"name\":\"TimeRange\",\"type\":4,\"isRequired\":true,\"value\":{\"durationMs\":86400000},\"typeSettings\":{\"selectableValues\":[{\"durationMs\":3600000},{\"durationMs\":14400000},{\"durationMs\":43200000},{\"durationMs\":86400000},{\"durationMs\":172800000},{\"durationMs\":604800000},{\"durationMs\":2592000000}]},\"label\":\"Time Range\"}],\"style\":\"pills\",\"queryType\":0},\"name\":\"parameters\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Event Summary\"},\"name\":\"overview-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union withsource=TableName SecurityEventDemo_CL, CommonSecurityLog, SigninLogDemo_CL, SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize EventCount = count() by TableName\\n| order by EventCount desc\",\"size\":1,\"title\":\"Events by Table\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"events-by-table\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union withsource=TableName SecurityEventDemo_CL, CommonSecurityLog, SigninLogDemo_CL, SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize EventCount = count() by bin(TimeGenerated, 1h), TableName\\n| order by TimeGenerated asc\",\"size\":0,\"title\":\"Events Over Time\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"linechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"SecurityEventDemo_CL\",\"color\":\"blue\"},{\"seriesName\":\"CommonSecurityLog\",\"color\":\"orange\"},{\"seriesName\":\"SigninLogDemo_CL\",\"color\":\"green\"},{\"seriesName\":\"SyslogDemo_CL\",\"color\":\"purple\"}]}},\"name\":\"events-timeline\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"union withsource=TableName SecurityEventDemo_CL, CommonSecurityLog, SigninLogDemo_CL, SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize TotalEvents = count(), FirstEvent = min(TimeGenerated), LastEvent = max(TimeGenerated) by TableName\\n| extend Duration = LastEvent - FirstEvent\\n| project TableName, TotalEvents, FirstEvent, LastEvent\",\"size\":0,\"title\":\"Table Statistics\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"TotalEvents\",\"formatter\":4,\"formatOptions\":{\"palette\":\"blue\"}}]}},\"name\":\"table-stats\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"overview\"},\"name\":\"overview-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Windows Security Events\\n\\nSimulated Windows security events including logon attempts, privilege escalation, and account management.\"},\"name\":\"security-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityEventDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by EventID\\n| order by Count desc\\n| take 10\",\"size\":1,\"title\":\"Top Event IDs\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"security-eventids\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityEventDemo_CL\\n| where TimeGenerated {TimeRange}\\n| where EventID == 4625\\n| summarize FailedAttempts = count() by IpAddress\\n| order by FailedAttempts desc\\n| take 10\",\"size\":0,\"title\":\"Failed Logons by Source IP (Event 4625)\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"FailedAttempts\",\"formatter\":4,\"formatOptions\":{\"palette\":\"red\"}}]}},\"name\":\"security-failed-logons\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityEventDemo_CL\\n| where TimeGenerated {TimeRange}\\n| project TimeGenerated, Computer, EventID, Activity, Account, IpAddress, Status\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Security Events\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"security-recent\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"security\"},\"name\":\"security-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## CommonSecurityLog (CEF)\\n\\nFirewall traffic, IDS alerts, and threat intelligence matches in CEF format.\"},\"name\":\"cef-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by DeviceVendor, DeviceProduct\\n| order by Count desc\",\"size\":1,\"title\":\"Events by Vendor/Product\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"cef-vendors\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by Activity\\n| order by Count desc\\n| take 10\",\"size\":0,\"title\":\"Top Activities\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"cef-activities\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog\\n| where TimeGenerated {TimeRange}\\n| where LogSeverity in (\\\"High\\\", \\\"Critical\\\", \\\"9\\\", \\\"10\\\")\\n| summarize Count = count() by SourceIP, Activity\\n| order by Count desc\\n| take 20\",\"size\":0,\"title\":\"High Severity Events by Source IP\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Count\",\"formatter\":4,\"formatOptions\":{\"palette\":\"redBright\"}}]}},\"name\":\"cef-high-severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"CommonSecurityLog\\n| where TimeGenerated {TimeRange}\\n| project TimeGenerated, DeviceVendor, DeviceProduct, Activity, LogSeverity, SourceIP, DestinationIP, Protocol\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent CEF Events\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"cef-recent\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"cef\"},\"name\":\"cef-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Azure AD Sign-in Logs\\n\\nSimulated Azure AD / Entra ID sign-in events including brute-force and credential stuffing attacks.\"},\"name\":\"signin-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Success = countif(ResultType == \\\"0\\\"), Failed = countif(ResultType != \\\"0\\\")\\n| project Success, Failed, Total = Success + Failed, FailureRate = round(100.0 * Failed / (Success + Failed), 1)\",\"size\":4,\"title\":\"Sign-in Summary\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"showBorder\":true}},\"name\":\"signin-summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| where ResultType != \\\"0\\\"\\n| summarize FailedCount = count() by UserPrincipalName\\n| order by FailedCount desc\\n| take 10\",\"size\":0,\"title\":\"Users with Most Failed Sign-ins\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"signin-failed-users\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by Location\\n| order by Count desc\",\"size\":1,\"title\":\"Sign-ins by Location\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"signin-locations\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize TotalSignIns = count(), SuccessCount = countif(ResultType == \\\"0\\\"), FailureCount = countif(ResultType != \\\"0\\\") by Location\\n| extend SuccessRate = round(100.0 * SuccessCount / TotalSignIns, 1)\\n| order by TotalSignIns desc\",\"size\":0,\"title\":\"Sign-in Count by Location\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"TotalSignIns\",\"formatter\":4,\"formatOptions\":{\"palette\":\"blue\"}},{\"columnMatch\":\"FailureCount\",\"formatter\":4,\"formatOptions\":{\"palette\":\"red\"}}]}},\"name\":\"signin-location-summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| where RiskLevelDuringSignIn in (\\\"high\\\", \\\"medium\\\")\\n| project TimeGenerated, UserPrincipalName, IPAddress, Location, RiskLevelDuringSignIn, ResultDescription\\n| order by TimeGenerated desc\\n| take 50\",\"size\":0,\"title\":\"Risky Sign-ins\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"signin-risky\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SigninLogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| project TimeGenerated, UserPrincipalName, AppDisplayName, IPAddress, Location, ResultType, ResultDescription, ClientAppUsed\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Sign-in Events\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"signin-recent\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"signin\"},\"name\":\"signin-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Syslog Events\\n\\nLinux syslog events including SSH authentication, sudo commands, and service status.\"},\"name\":\"syslog-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by Facility\\n| order by Count desc\",\"size\":1,\"title\":\"Events by Facility\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"syslog-facilities\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Count = count() by SeverityLevel\\n| order by Count desc\",\"size\":0,\"title\":\"Events by Severity\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"syslog-severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| where ProcessName == \\\"sshd\\\" and SyslogMessage has \\\"Failed\\\"\\n| summarize FailedAttempts = count() by HostIP\\n| order by FailedAttempts desc\\n| take 10\",\"size\":0,\"title\":\"SSH Failed Logins by Source IP\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"FailedAttempts\",\"formatter\":4,\"formatOptions\":{\"palette\":\"red\"}}]}},\"name\":\"syslog-ssh-failed\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| where SeverityLevel in (\\\"err\\\", \\\"crit\\\", \\\"alert\\\", \\\"emerg\\\")\\n| project TimeGenerated, Computer, Facility, SeverityLevel, ProcessName, SyslogMessage\\n| order by TimeGenerated desc\\n| take 50\",\"size\":0,\"title\":\"Error and Critical Events\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"syslog-errors\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SyslogDemo_CL\\n| where TimeGenerated {TimeRange}\\n| project TimeGenerated, Computer, Facility, SeverityLevel, ProcessName, SyslogMessage\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Syslog Events\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"syslog-recent\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"syslog\"},\"name\":\"syslog-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Alerts & Incidents\\n\\nAlerts and incidents generated by the [Demo] analytic rules from the Sentinel Data Generator.\"},\"name\":\"alerts-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityAlert\\n| where TimeGenerated {TimeRange}\\n| where AlertName startswith \\\"[Demo]\\\"\\n| summarize AlertCount = count() by AlertName, AlertSeverity\\n| order by AlertCount desc\",\"size\":0,\"title\":\"Alerts by Rule\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"AlertCount\",\"formatter\":4,\"formatOptions\":{\"palette\":\"red\"}},{\"columnMatch\":\"AlertSeverity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"High\",\"representation\":\"Sev1\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Medium\",\"representation\":\"Sev2\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Low\",\"representation\":\"Sev3\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Informational\",\"representation\":\"Sev4\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"representation\":\"Unknown\",\"text\":\"{0}{1}\"}]}}]}},\"name\":\"alerts-by-rule\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityAlert\\n| where TimeGenerated {TimeRange}\\n| where AlertName startswith \\\"[Demo]\\\"\\n| summarize Count = count() by bin(TimeGenerated, 1h), AlertSeverity\\n| order by TimeGenerated asc\",\"size\":0,\"title\":\"Alerts Over Time\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"linechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"High\",\"color\":\"redBright\"},{\"seriesName\":\"Medium\",\"color\":\"orange\"},{\"seriesName\":\"Low\",\"color\":\"yellow\"},{\"seriesName\":\"Informational\",\"color\":\"blue\"}]}},\"name\":\"alerts-over-time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityAlert\\n| where TimeGenerated {TimeRange}\\n| where AlertName startswith \\\"[Demo]\\\"\\n| project TimeGenerated, AlertName, AlertSeverity, Description, Entities\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Alerts\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"alerts-recent\"},{\"type\":1,\"content\":{\"json\":\"---\\n## Incidents\"},\"name\":\"incidents-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\n| where TimeGenerated {TimeRange}\\n| where Title startswith \\\"[Demo]\\\"\\n| summarize Count = count() by Severity\\n| order by Count desc\",\"size\":1,\"title\":\"Incidents by Severity\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"incidents-by-severity\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\n| where TimeGenerated {TimeRange}\\n| where Title startswith \\\"[Demo]\\\"\\n| summarize Count = count() by Status\\n| order by Count desc\",\"size\":1,\"title\":\"Incidents by Status\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"piechart\"},\"name\":\"incidents-by-status\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\n| where TimeGenerated {TimeRange}\\n| where Title startswith \\\"[Demo]\\\"\\n| summarize Count = count() by bin(TimeGenerated, 1h), Status\\n| order by TimeGenerated asc\",\"size\":0,\"title\":\"Incidents Over Time\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"linechart\"},\"name\":\"incidents-over-time\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityIncident\\n| where TimeGenerated {TimeRange}\\n| where Title startswith \\\"[Demo]\\\"\\n| extend AssignedTo = tostring(Owner.assignedTo)\\n| project TimeGenerated, Title, Severity, Status, AssignedTo\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Incidents\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Severity\",\"formatter\":18,\"formatOptions\":{\"thresholdsOptions\":\"icons\",\"thresholdsGrid\":[{\"operator\":\"==\",\"thresholdValue\":\"High\",\"representation\":\"Sev1\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Medium\",\"representation\":\"Sev2\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Low\",\"representation\":\"Sev3\",\"text\":\"{0}{1}\"},{\"operator\":\"==\",\"thresholdValue\":\"Informational\",\"representation\":\"Sev4\",\"text\":\"{0}{1}\"},{\"operator\":\"Default\",\"representation\":\"Unknown\",\"text\":\"{0}{1}\"}]}}]}},\"name\":\"incidents-recent\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"SecurityAlert\\n| where TimeGenerated {TimeRange}\\n| where AlertName startswith \\\"[Demo]\\\"\\n| mv-expand Entity = parse_json(Entities)\\n| where Entity.Type in (\\\"account\\\", \\\"ip\\\", \\\"host\\\")\\n| extend EntityName = coalesce(tostring(Entity.Name), tostring(Entity.Address), tostring(Entity.HostName))\\n| where isnotempty(EntityName)\\n| summarize AlertCount = dcount(SystemAlertId) by EntityName, EntityType = tostring(Entity.Type)\\n| order by AlertCount desc\\n| take 15\",\"size\":0,\"title\":\"Most Targeted Entities\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"AlertCount\",\"formatter\":4,\"formatOptions\":{\"palette\":\"orange\"}}]}},\"name\":\"targeted-entities\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"alerts\"},\"name\":\"alerts-group\"},{\"type\":12,\"content\":{\"version\":\"NotebookGroup/1.0\",\"groupType\":\"editable\",\"items\":[{\"type\":1,\"content\":{\"json\":\"## Brute Force Demo\\n\\nLive PIN-cracking attempts from the audience. Every guess submitted via the Brute Force Demo web app is logged to `BruteForceDemo_CL`.\"},\"name\":\"bruteforce-header\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BruteForceDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize TotalAttempts = count(), Successes = countif(AttemptResult == \\\"Success\\\"), UniqueUsers = dcount(Nickname), UniquePins = dcount(Pincode)\",\"size\":4,\"title\":\"Brute Force Summary\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"tiles\",\"tileSettings\":{\"showBorder\":true}},\"name\":\"bruteforce-summary\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BruteForceDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Attempts = count() by bin(TimeGenerated, 1m), AttemptResult\\n| order by TimeGenerated asc\",\"size\":0,\"title\":\"Attempts Over Time\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"linechart\",\"chartSettings\":{\"seriesLabelSettings\":[{\"seriesName\":\"Failure\",\"color\":\"red\"},{\"seriesName\":\"Success\",\"color\":\"green\"}]}},\"name\":\"bruteforce-timeline\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BruteForceDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Attempts = count(), Successes = countif(AttemptResult == \\\"Success\\\"), DistinctPins = dcount(Pincode) by Nickname\\n| order by Attempts desc\",\"size\":0,\"title\":\"Attempts by Nickname\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\",\"gridSettings\":{\"formatters\":[{\"columnMatch\":\"Attempts\",\"formatter\":4,\"formatOptions\":{\"palette\":\"blue\"}},{\"columnMatch\":\"Successes\",\"formatter\":4,\"formatOptions\":{\"palette\":\"green\"}}]}},\"name\":\"bruteforce-by-nickname\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BruteForceDemo_CL\\n| where TimeGenerated {TimeRange}\\n| summarize Attempts = count() by Pincode\\n| order by Attempts desc\\n| take 20\",\"size\":1,\"title\":\"Most Guessed PINs\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"barchart\"},\"name\":\"bruteforce-pins\"},{\"type\":3,\"content\":{\"version\":\"KqlItem/1.0\",\"query\":\"BruteForceDemo_CL\\n| where TimeGenerated {TimeRange}\\n| project TimeGenerated, Nickname, Pincode, AttemptResult, SourceIP, UserAgent\\n| order by TimeGenerated desc\\n| take 100\",\"size\":0,\"title\":\"Recent Attempts\",\"timeContext\":{\"durationMs\":86400000},\"timeContextFromParameter\":\"TimeRange\",\"queryType\":0,\"resourceType\":\"microsoft.operationalinsights/workspaces\",\"visualization\":\"table\"},\"name\":\"bruteforce-recent\"}]},\"conditionalVisibility\":{\"parameterName\":\"tab\",\"comparison\":\"isEqualTo\",\"value\":\"bruteforce\"},\"name\":\"bruteforce-group\"}],\"isLocked\":false}')]",
        "version": "1.0",
        "sourceId": "[parameters('workbookSourceId')]",
        "category": "sentinel"
      }
    }
  ],
  "outputs": {
    "workbookId": {
      "type": "string",
      "value": "[resourceId('Microsoft.Insights/workbooks', variables('workbookId'))]"
    }
  }
}
# Sentinel Data Generator - Example Configuration
# Copy this file to config/config.yaml and fill in your values.
# NEVER commit config.yaml with real credentials.

# Azure Log Analytics / Data Collection settings
# These can also be set via environment variables:
#   SENTINEL_DCE_ENDPOINT  → overrides azure.dce_endpoint
#   SENTINEL_DCR_ID        → overrides azure.dcr_id
#   SENTINEL_STREAM_NAME   → overrides azure.stream_name
azure:
  dce_endpoint: "https://<your-dce>.<region>.ingest.monitor.azure.com"
  dcr_id: "dcr-xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"
  stream_name: "Custom-SecurityEventDemo_CL"

# Output target: log_analytics | file | stdout
output:
  type: stdout
  # For file output:
  # file_path: output/events.json
  # file_format: json  # json or csv

# Global generation settings
generation:
  count: 50             # Default number of events per scenario
  time_range:
    start: "2025-06-15T00:00:00Z"
    end: "2025-06-16T00:00:00Z"
  seed: null            # Optional random seed for reproducibility

# Scenarios to simulate
# Each scenario maps to a registered generator via log_type.
# Supported log_type values: security_event
# Coming soon: signin_logs, syslog, common_security_log
scenarios:
  - name: brute_force_login
    log_type: security_event
    stream_name: "Custom-SecurityEventDemo_CL"
    description: "Simulate brute-force login attempts against a Windows server"
    count: 50
    parameters:
      target_host: "DC01.contoso.com"
      target_account: "admin"
      source_ip: "203.0.113.50"
      event_ids: [4625, 4625, 4625, 4625, 4624]  # 4 failures then 1 success

  - name: privilege_escalation
    log_type: security_event
    stream_name: "Custom-SecurityEventDemo_CL"
    description: "Simulate privilege escalation — new account creation and special logon"
    count: 20
    parameters:
      target_host: "DC02.contoso.com"
      target_account: "svc_backup"
      event_ids: [4720, 4672, 4624]

  # CommonSecurityLog scenarios - ingest to NATIVE CommonSecurityLog table
  - name: firewall_traffic
    log_type: common_security_log_native
    stream_name: "Custom-CommonSecurityLogNative"
    description: "Simulate mixed firewall traffic (allow/deny)"
    count: 100
    parameters:
      vendor: "Palo Alto Networks"

  - name: ids_intrusion_detection
    log_type: common_security_log_native
    stream_name: "Custom-CommonSecurityLogNative"
    description: "Simulate IDS alerts and intrusion attempts"
    count: 30
    parameters:
      event_type: "ids_alert"
      threat_actor_ip: true

  - name: threat_intel_matches
    log_type: common_security_log_native
    stream_name: "Custom-CommonSecurityLogNative"
    description: "Simulate threat intelligence IOC matches"
    count: 20
    parameters:
      event_type: "threat_intelligence"
      threat_actor_ip: true

  # SigninLogs scenarios - ingest to custom SigninLogDemo_CL table
  # (Native SigninLogs table is protected - only Entra ID can write to it)
  - name: suspicious_signins
    log_type: signin_logs
    stream_name: "Custom-SigninLogDemo_CL"
    description: "Simulate suspicious Azure AD sign-ins from risky locations"
    count: 50
    parameters:
      risky_locations: true
      failure_rate: 0.3

  - name: brute_force_aad
    log_type: signin_logs
    stream_name: "Custom-SigninLogDemo_CL"
    description: "Simulate brute-force attacks against Azure AD accounts"
    count: 30
    parameters:
      target_user: "admin@contoso.com"
      attack_type: "brute_force"

  - name: credential_stuffing
    log_type: signin_logs
    stream_name: "Custom-SigninLogDemo_CL"
    description: "Simulate credential stuffing attack (many users, same password)"
    count: 40
    parameters:
      attack_type: "credential_stuffing"

  # Syslog scenarios - ingest to custom SyslogDemo_CL table
  # (Native Syslog table requires specific agent-based ingestion)
  - name: ssh_brute_force
    log_type: syslog
    stream_name: "Custom-SyslogDemo_CL"
    description: "Simulate SSH brute-force attacks against Linux servers"
    count: 80
    parameters:
      event_type: "ssh_failure"
      attacker_ip: "203.0.113.100"

  - name: linux_auth_events
    log_type: syslog
    stream_name: "Custom-SyslogDemo_CL"
    description: "Simulate mixed Linux authentication events"
    count: 50
    parameters:
      event_type: "sudo_success"

  - name: service_anomalies
    log_type: syslog
    stream_name: "Custom-SyslogDemo_CL"
    description: "Simulate service start/stop and failure events"
    count: 30
    parameters:
      event_type: "service_failure"
